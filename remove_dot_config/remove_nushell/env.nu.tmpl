# Nushell Environment Config File

##########################################################################################
# Useful stuff from default env.nu

$env.ENV_CONVERSIONS = {
	'PATH': {
		from_string: { |s| $s | split row (char esep) | path expand --no-symlink }
		to_string: { |v| $v | path expand --no-symlink | str join (char esep) }
	}
	'Path': {
		from_string: { |s| $s | split row (char esep) | path expand --no-symlink }
		to_string: { |v| $v | path expand --no-symlink | str join (char esep) }
	}
}

# Directories to search for scripts when calling source or use
# The default for this is $nu.default-config-dir/scripts
$env.NU_LIB_DIRS = [
	($nu.default-config-dir | path join 'scripts') # add <nushell-config-dir>/scripts
	($nu.data-dir | path join 'completions') # default home for nushell completions
]

# Directories to search for plugin binaries when calling register
# The default for this is $nu.default-config-dir/plugins
$env.NU_PLUGIN_DIRS = [
	($nu.default-config-dir | path join 'plugins') # add <nushell-config-dir>/plugins
]

##########################################################################################
# Environment

$env.HOMEBREW_PREFIX = '/opt/homebrew'
$env.HOMEBREW_CELLAR = '/opt/homebrew/Cellar'
$env.HOMEBREW_REPOSITORY = '/opt/homebrew'
$env.INFOPATH = '/opt/homebrew/share/info'

$env.PATH = (
	$env.PATH
	| split row (char esep)
	| prepend [
		~/.local/bin,
{{- if .lang.rust }}
		~/.cargo/bin
{{- end }}
{{- if .lang.cpp }}
		$'($env.HOMEBREW_PREFIX)/opt/llvm/bin'
{{- end }}
		/opt/homebrew/bin,
		/opt/homebrew/sbin,
	]
	| uniq
)

$env.LANG = 'en_US.UTF-8'
$env.LC_ALL = 'en_US.UTF-8'

$env.FZF_DEFAULT_OPTS = '--color=16'

{{- if .helix.enabled }}

$env.EDITOR = {{ .helix.executable | quote }}
$env.VISUAL = {{ .helix.executable | quote }}

{{- end }}

{{- if .bat.enabled }}

$env.MANPAGER = 'sh -c "col -bx | bat --language man --style=plain"'

{{- end }}

{{- if .lang.cpp }}

$env.CC = 'clang'
$env.CXX = 'clang++'

{{- end }}

{{- if .lang.dotnet }}

$env.DOTNET_ROOT = $'($env.HOMEBREW_PREFIX)/opt/dotnet/libexec'

{{- end }}
